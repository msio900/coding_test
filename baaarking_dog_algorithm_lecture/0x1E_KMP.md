# âœï¸0x1Eê°• KMP

>
> ì˜ìƒ URL[ğŸ“¹](https://youtu.be/9bkbV-VANQ0)

## ğŸ“‘Contents<a id='contents'></a>

* 0x00 ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… [ğŸ‘‰ğŸ»](#0x00)
* 0x01 ì‹¤íŒ¨ í•¨ìˆ˜ [ğŸ‘‰ğŸ»](#0x01)
* 0x02 KMP [ğŸ‘‰ğŸ»](#0x02)

## 0x00 ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… [ğŸ“‘](#contents)<a id='0x00'></a>

* ë³¸ê²©ì ìœ¼ë¡œ ë“¤ì–´ê°€ê¸° ì „ ì„¤ëª…ì˜ ì´í•´ë¥¼ ë•ê¸°ìœ„í•œ ì›ì¹™

  ```python
  '''
  1. S[a:b] = "S[a] S[a+1] ... S[b-1]"
  2. S = "ABCDEF"ì¼ ë•Œ S[2:5] = "CDE", S[3:4] = "D", S[0:2] = "AB"
  3. |S|ëŠ” Sì˜ ê¸¸ì´, S = "ABCDEF"ì¼ ë•Œ |S| = 6
  4. ì ‘ë‘ì‚¬ = ë¬¸ìì—´ì˜ ì²« ë¬¸ìë¥¼ í¬í•¨í•˜ëŠ” ì—°ì†í•œ ë¬¸ìì—´, S[0:x]
  5. ì ‘ë¯¸ì‚¬ = ë¬¸ìì—´ì˜ ë ë¬¸ìë¥¼ í¬í•¨í•˜ëŠ” ì—°ì†í•œ ë¬¸ìì—´, S[x:|S|]
  6. A, AB, ABC, ABCD, ABCDE, ABCDEFëŠ” ABCDEFì˜ ì ‘ë‘ì‚¬
  7. F, EF, DEF, CDEF, BCDEF, ABCDEFëŠ” ABCDEFì˜ ì ‘ë¯¸ì‚¬
  '''
  ```

### íŒ¨í„´ ë§¤ì¹­ ë¬¸ì œ

![image-20221228143253016](images/image-20221228143253016.png)

* ë¬¸ìì—´ Aì•ˆì— ë¬¸ìì—´ Bê°€ ë“¤ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜

![KMP_1](images/KMP_1.gif)

* êµ¬í˜„

  ```c++
  bool find(string& A, string& B){
      for(int st = 0; st < (int)(A.size() - B.size()); st++){
          bool match = true;
          for(int i = 0; i < B.size(); i++){
              if(A[st+1] != B[i]){
                  match = false;
                  break;
              }
          }
          if(match) return true;
      }
      return false;
  }
  ```

* ìµœì•…ì˜ ì˜ˆì‹œ

  ![KMP_2](images/KMP_2.gif)

  * ìµœì•…ì˜ ê²½ìš° `O(|A| X |B|)`ì— ë™ì‘
    â†’ ë¬¸ìì—´ Aì˜ ê¸¸ì´ì™€ ë¬¸ìì—´ Bì˜ ê¸¸ì´ê°€ ê°ê° 100ë§Œì¸ê²ƒ ê°™ì´ íŠ¹ìˆ˜í•  ê²½ìš°ì—ëŠ” í•´ê²°í•  ìˆ˜ ì—†ìŒ.

## 0x01 ì‹¤íŒ¨ í•¨ìˆ˜ [ğŸ“‘](#contents)<a id='0x01'></a>

```python
'''
1. KMP : íŒ¨í„´ ë§¤ì¹­ ë¬¸ì œë¥¼ O(|A|+|B|)ì— í•´ê²°í•  ìˆ˜ ìˆëŠ” ê¸°ì ì˜ ì•Œê³ ë¦¬ì¦˜
2. êµ‰ì¥íˆ í—·ê°ˆë¦¼
3. ë¨¼ì €, KMPì— ì“°ì´ëŠ” ì‹¤íŒ¨ í•¨ìˆ˜ë¥¼ ì•Œë©´ KMPë¥¼ ì´í•´í•˜ëŠ”ë° ë„ì›€ì´ ë¨
'''
```

* ì‹¤íŒ¨ í•¨ìˆ˜ F(x) : ë¬¸ìì—´ S[0:x+1]ì—ì„œ ì ‘ë‘ì‚¬ì™€ ì ‘ë¯¸ì‚¬ê°€ ì¼ì¹˜í•˜ëŠ” ìµœëŒ€ ê¸¸ì´

  ![image-20221228144458703](images/image-20221228144458703.png)

* F(2)ì— ëŒ€í•œ ì˜ˆì‹œ

  ![image-20221228144517348](images/image-20221228144517348.png)

  ![image-20221228144554470](images/image-20221228144554470.png)

* F(5) = ?

  ![KMP_3](images/KMP_3.gif)

  * F(5) = 1ì„ì„ ì•Œê²Œë¨.
  * F(x)ì— ëŒ€í•´ ìµœì•…ì˜ ê²½ìš° `O(|S|^2)`ì˜ ì—°ì‚°ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì‹œê°„ë³µì¡ë„ëŠ” `O(|S|^3)`

**í•˜ì§€ë§Œ ì „ì²´ Fë¥¼ O(|S|)ì— êµ¬í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•¨** 
â†’ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡œê·¸ë˜ë°ê³¼ ê°™ì´ ì´ì „ì˜ Fë¥¼ í™œìš©í•  ìˆ˜ ìˆì–´ì•¼ í•¨.

![image-20221228155547188](images/image-20221228155547188.png)

* F(5) = 1ì„ì„ ì•ì„œ ì°¾ì•„ë‚´ì—ˆê¸° ë•Œë¬¸ì— F(5)ì—ì„œ ë¬¸ìì—´ S ì ‘ë¯¸ì‚¬ì™€ ì ‘ë‘ì‚¬ê°€ ì¼ì¹˜í•˜ëŠ” ìë¦¬ ë°”ë¡œ ë‹¤ìŒì˜ ë¬¸ìê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸ 
  â†’ ì—°í•œ ì´ˆë¡, ì§„í•œ ì´ˆë¡ìœ¼ë¡œ ëœ Bê°€ ì¼ì¹˜í•¨ì„ ë³¼ ìˆ˜ ìˆìŒ

* F(6) > 2 ì¼ìˆ˜ëŠ” ì—†ëŠ”ê°€?

  > ë…¼ë¦¬ì ì¸ ìƒê°ìœ¼ë¡œ F(5)ê°€ 1ì¸ ìƒíƒœì—ì„œ F(6)ì€ 2ë³´ë‹¤ í´ ìˆ˜ ì—†ë‹¤.

  ![image-20221228160008494](images/image-20221228160008494.png)

F(k) ë¥¼ êµ¬í• ë•Œ F(k-1)ì˜ã…£ ê°’ì„ ì´ìš©í•  ìˆ˜ ìˆëŠ”ë°, F(k)ëŠ” ìµœëŒ€ F(k-1)+1ì„
â†’ ìœ„ì˜ ì˜ˆì‹œì²˜ëŸ¼ S[F(k-1)]ê³¼ S[k]ë¥¼ ë¹„êµí•´ì„œ ë‘ ê¸€ìê°€ ì¼ì¹˜í•œë‹¤ë©´ ë°”ë¡œ F(k) = F(k-1)+1ë¡œ í™•ì •ì§€ì„ ìˆ˜ ìˆìŒ.

í•œí¸, F(k)ë¥¼ êµ¬í• ë•Œ ì™œ S[F(k-1)]ê³¼ S[k]ì´ ë‘ ê¸€ìë¥¼ ë¹„êµí•˜ëŠ”ì§€ ì•½ê°„ í—·ê°ˆë¦´ ìˆ˜ ìˆìŒ.

![image-20221228160444386](images/image-20221228160444386.png)

### ì‹¤íŒ¨ í•¨ìˆ˜ ì›ë¦¬ ì„¤ëª…

ì˜ìƒì„ í†µí•´ ë‹¤ì‹œ ì´í•´í•´ë³´ê¸°...[âœï¸](https://youtu.be/9bkbV-VANQ0?t=630)

### êµ¬í˜„

```c++
vector<int> failure(string& s){
    vector<int> f(s.size());
    int j = 0;
    for(int i = 1; i < s.size(); i++){
        while(j > 0 && s[i] != s[j]) j = f[j-1];
        if(s[i] == s[j]) f[i] = ++j;
    }
    return f;
}
```

## 0x02 KMP [ğŸ“‘](#contents)<a id='0x02'></a>

ì˜ìƒì„ í†µí•´ ë‹¤ì‹œ ì´í•´í•´ë³´ê¸°...[âœï¸](https://youtu.be/9bkbV-VANQ0?t=1097)

### ë°±ì¤€ 16916ë²ˆ : ë¶€ë¶„ë¬¸ìì—´ [ë¬¸ì œâŒ¨ï¸](https://www.acmicpc.net/problem/16916)

> í’€ì´[âœï¸](../acmicpc/16916/16916.md)

* ë°”í‚¹ë…ë‹˜ í’€ì´

  ```c++
  #include <bits/stdc++.h>
  using namespace std;
  
  vector<int> failure(string& s){
    vector<int> f(s.size());
    int j = 0;
    for(int i = 1; i < s.size(); i++){
      while(j > 0 && s[i] != s[j]) j = f[j-1];
      if(s[i] == s[j]) f[i] = ++j;
    }
    return f;
  }
  
  int main(void) {
    ios::sync_with_stdio(0);
    cin.tie(0);
  
    string s, p;
    cin >> s >> p;
    vector<int>f = failure(p);
    int j = 0;
    for(int i = 0; i < s.size(); i++){
      while(j > 0 && s[i] != p[j]) j = f[j-1];
      if(s[i] == p[j]) j++;
      if(j == p.size()){
        cout << 1;
        return 0;
      }
    }
    cout << 0;
  }
  ```

* python í’€ì´

  ```python
  import sys
  
  input = sys.stdin.readline
  
  def failure(s: str) -> list[int]:
      f = [0] * len(s)
      j = 0
      for i in range(1, len(s)):
          while j > 0 and s[i] != s[j]:
              j = f[j - 1]
          if s[i] == s[j]:
              j += 1
              f[i] = j
      return f
  
  s = input().rstrip()
  p = input().rstrip()
  
  f = failure(p)
  j = 0
  for i in range(len(s)):
      while j > 0 and s[i] != p[j]:
          j = f[j - 1]
      if s[i] == p[j]:
          j += 1
      if j == len(p):
          print(1)
          break
  else:
      print(0)
  ```

  



