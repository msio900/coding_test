# 9_μµλ‹¨ κ²½λ΅(shortest path) [β†©](../this_is_codingtest)

## contentsπ“‘<a id="contents"></a>

1. κ°€μ¥ λΉ λ¥Έ κΈΈ μ°ΎκΈ°[π‘‰](#8_1)
   * μµλ‹¨ κ²½λ΅ λ¬Έμ 
   * λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦

## 9_1 κ°€μ¥ λΉ λ¥Έ κΈΈ μ°ΎκΈ°[π“‘](#contents)<a id="9_1"></a>

### μµλ‹¨ κ²½λ΅ λ¬Έμ 

![](./image/9_1-1.png)

* μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ€ **κ°€μ¥ μ§§μ€ κ²½λ΅λ¥Ό μ°Ύλ” μ•κ³ λ¦¬μ¦** μ„ μλ―Έν•¨
* λ‹¤μ–‘ν• λ¬Έμ  μƒν™©
  * ν• μ§€μ μ—μ„ λ‹¤λ¥Έ ν• μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅
  * ν• μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ ‘κΉμ§€μ μµλ‹¨ κ²½λ΅
  * λ¨λ“  μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅
* κ° μ§€μ μ€ κ·Έλν”„μ—μ„ λ…Έλ“λ΅ ν‘ν„
* μ§€μ  κ°„ μ—°κ²°λ λ„λ΅λ” κ·Έλν”„μ—μ„ κ°„μ„ μΌλ΅ ν‘ν„

### λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦ 

#### κ°μ”

* **νΉμ •ν• λ…Έλ“** μ—μ„ μ¶λ°ν•μ—¬ λ‹¤λ¥Έ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ²½λ΅λ¥Ό κ³„μ‚°ν•¨

* λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ€ μμ κ°„μ„­μ΄ μ—†μ„ λ• μ •μƒμ μΌλ΅ λ™μ‘ν•¨

  * ν„μ‹¤μ„Έκ³„μ λ„λ΅(κ°„μ„ )μ€ μμ κ°„μ„ μΌλ΅ ν‘ν„λμ§€ μ•μ

* λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ€ κ·Έλ¦¬λ”” μ•κ³ λ¦¬μ¦μΌλ΅ λ¶„λ¥λ¨

  * **λ§¤ μƒν™©μ—μ„ κ°€μ¥ λΉ„μ©μ΄ μ μ€ λ…Έλ“λ¥Ό μ„ νƒ** ν•΄ μ„μμ κ³Όμ •μ„ λ°λ³µν•¨

* λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ **λ™μ‘ κ³Όμ •**μ€ λ‹¤μκ³Ό κ°™μ.

  1. μ¶λ° λ…Έλ“λ¥Ό μ„¤μ •ν•¨
  2. μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ μ΄κΈ°ν™” ν•¨
  3. λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒ
  4. ν•΄λ‹Ή λ…Έλ“λ¥Ό κ±°μ³ λ‹¤λ¥Έ λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ„ κ³„μ‚°ν•μ—¬ μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ κ°±μ‹ ν•¨
  5. μ„ κ³Όμ •μ—μ„ 3λ²κ³Ό 4λ²μ„ λ°λ³µ

* μ•κ³ λ¦¬μ¦ μΆ…μ‘ κ³Όμ •μ—μ„ μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ€ κ° λ…Έλ“μ— λ€ν• ν„μ¬κΉμ§€μ μµλ‹¨ κ±°λ¦¬ μ •λ³΄λ¥Ό κ°€μ§€κ³  μμ

* μ²λ¦¬κ³Όμ •μ—μ„ λ” μ§§μ€ κ²½λ΅λ¥Ό μ°ΎμΌλ©΄ 'μ΄μ λ¶€ν„° μ΄ κ²½λ΅κ°€ μ μΌ μ§§μ€ κ²½λ΅μ•Ό'λΌκ³  κ°±μ‹ ν•¨

  ![](./image/9_1-2.png)

  ![](./image/9_1-3.png)

#### λ™μ‘ κ³Όμ • μ‚΄ν΄λ³΄κΈ°

* [μ΄κΈ° μƒνƒ] κ·Έλν”„λ¥Ό μ¤€λΉ„ν•κ³  μ¶λ°λ…Έλ“λ¥Ό μ„¤μ •ν•¨

  ![](./image/9_1-4.png)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• |

* [Step 1] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 1λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-5.png)

  | μΈμ ‘ λ…Έλ“ | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | --------- | ------- | --------- | --------- |
  | 2λ²       | λ¬΄ν•    | 0+2       | True      |
  | 3λ²       | λ¬΄ν•    | 0+5       | True      |
  | 4λ²       | λ¬΄ν•    | 0+1       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 5    | 1    | λ¬΄ν• | λ¬΄ν• |

* [Step 2] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 4λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-6.png)

  | μΈμ ‘ λ…Έλ“ | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | --------- | ------- | --------- | --------- |
  | 3λ²       | 5       | 1+3       | True      |
  | 5λ²       | λ¬΄ν•    | 1+1       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 4    | 1    | 2    | λ¬΄ν• |

* [Step 3] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 2λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-7.png)

    |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
    | ---- | ------- | --------- | --------- |
    | 3λ²  | 4       | 2+3       | False     |
    | 5λ²  | 1       | 2+2       | False     |

    > ν„μ¬ κ°’λ³΄λ‹¤ κ±°μ³κ°€λ” κ°’μ΄ λ” ν¬κΈ° λ•λ¬Έμ— κ°±μ‹ ν•μ§€ μ•μ.
    >
    > (ν„μ¬ κ°’ < κ±°μ³κ°€λ” κ°’)

    | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
    | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
    | κ±°λ¦¬      | 0    | 2    | 4    | 1    | 2    | λ¬΄ν• |

* [Step 4] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 5λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-9.png)

  |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | ---- | ------- | --------- | --------- |
  | 3λ²  | 4       | 2+1       | True      |
  | 6λ²  | λ¬΄ν•    | 2+2       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 5] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 3λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-10.png)

  |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | ---- | ------- | --------- | --------- |
  | 2λ²  | 2       | 3+3       | False     |
  | 6λ²  | 4       | 3+5       | False     |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 6] λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“μΈ 6λ² λ…Έλ“λ¥Ό μ²λ¦¬ν•¨

  * λ§μ§€λ§‰ λ…Έλ“λ” μ²λ¦¬ν•μ§€ μ•μ•„λ„ λ¨
  * μ•μ„ ν™•μΈν–λ λ‹¤λ¥Έ λ…Έλ“κΉμ§€μ μµλ‹¨κ±°λ¦¬λ” λ³€ν•μ§€ μ•μ

  ![](./image/9_1-11.png)

  * μ΄ μμ  μ—μ„λ” 6λ² λ…Έλ“μ—μ„ μ¶λ°ν•λ” κ°„μ„ μ΄ μ΅΄μ¬ ν•μ§€ μ•μ

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

#### νΉμ§•

* κ·Έλ¦¬λ”” μ•κ³ λ¦¬μ¦ : **λ§¤ μƒν™©μ—μ„ λ°©λ¬Έν•μ§€ μ•μ€ κ°€μ¥ λΉ„μ©μ΄ μ μ€ λ…Έλ“λ¥Ό μ„ νƒ**ν•΄ μ„μμ κ³Όμ •μ„ λ°λ³µν•¨
* λ‹¨κ³„λ¥Ό κ±°μΉλ©° **ν• λ² μ²λ¦¬λ λ…Έλ“μ μµλ‹¨ κ±°λ¦¬λ” κ³ μ •**λμ–΄ λ” μ΄μƒ λ°”λ€μ§€ μ•μ
  * **ν• λ‹¨κ³„λ‹Ή ν•λ‚μ λ…Έλ“μ— λ€ν• μµλ‹¨ κ±°λ¦¬λ¥Ό ν™•μ‹¤ν μ°Ύλ” κ²ƒμΌλ΅ μ΄ν•΄**ν•  μ μμ
* λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μν–‰ν• λ’¤μ— <u>ν…μ΄λΈ”μ—μ„ κ° λ…Έλ“κΉμ§€μ μµλ‹¨ κ±°λ¦¬ μ •λ³΄</u>κ°€ μ €μ¥λ¨
  * μ™„λ²½ν• ν•νƒμ μµλ‹¨ κ²½λ΅λ¥Ό κµ¬ν•λ ¤λ©΄ μ†μ¤μ½”λ“μ— μ¶”κ°€μ μΈ κΈ°λ¥μ„ λ” λ„£μ–΄μ•Ό ν•¨

#### κ°„λ‹¨ν• κµ¬ν„ λ°©λ²•

* λ‹¨κ³„λ§λ‹¤ λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒν•κΈ° μ„ν•΄ **λ§¤ λ‹¨κ³„λ§λ‹¤ 1μ°¨μ› ν…μ΄λΈ”μ λ¨λ“  μ›μ†λ¥Ό ν™•μΈ(μμ°¨ νƒμƒ‰)**ν•¨

  ```python
  import sys
  input = sys.stdin.readline
  INF = int(1e9) # λ¬΄ν•μ„ μλ―Έν•λ” κ°’μΌλ΅ 10μ–µμ„ μ„¤μ •
  
  # λ…Έλ“μ κ°μ, κ°„μ„ μ κ°μλ¥Ό μ…λ ¥λ°›κΈ°
  n, m = map(int, input().split())
  # μ‹μ‘ λ…Έλ“ λ²νΈλ¥Ό μ…λ ¥λ°›κΈ°
  start = int(input())
  # κ° λ…Έλ“μ— μ—°κ²°λμ–΄ μλ” λ…Έλ“μ— λ€ν• μ •λ³΄λ¥Ό λ‹΄λ” λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
  graph = [[] for i in range(n + 1)]
  # λ°©λ¬Έν• μ μ΄ μλ”μ§€ μ²΄ν¬ν•λ” λ©μ μ λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
  visited = [False] * (n + 1)
  # μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ λ¨λ‘ λ¬΄ν•μΌλ΅ μ΄κΈ°ν™”
  distance = [INF] * (n + 1)
  
  # λ¨λ“  κ°„μ„  μ •λ³΄λ¥Ό μ…λ ¥λ°›κΈ°
  for _ in range(m):
      a, b, c = map(int, input().split())
      # aλ² λ…Έλ“μ—μ„ bλ² λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ΄ cλΌλ” μλ―Έ
      graph[a].append((b, c))
  
  # λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„, κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“μ λ²νΈλ¥Ό λ°ν™
  def get_smallest_node():
      min_value = INF
      index = 0 # κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“(μΈλ±μ¤)
      for i in range(1, n + 1):
          if distance[i] < min_value and not visited[i]:
              min_value = distance[i]
              index = i
      return index
  
  def dijkstra(start):
      # μ‹μ‘ λ…Έλ“μ— λ€ν•΄μ„ μ΄κΈ°ν™”
      distance[start] = 0
      visited[start] = True
      for j in graph[start]:
          distance[j[0]] = j[1]
      # μ‹μ‘ λ…Έλ“λ¥Ό μ μ™Έν• μ „μ²΄ n - 1κ°μ λ…Έλ“μ— λ€ν•΄ λ°λ³µ
      for i in range(n - 1):
          # ν„μ¬ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό κΊΌλ‚΄μ„, λ°©λ¬Έ μ²λ¦¬
          now = get_smallest_node()
          visited[now] = True
          # ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ λ…Έλ“λ¥Ό ν™•μΈ
          for j in graph[now]:
              cost = distance[now] + j[1]
              # ν„μ¬ λ…Έλ“λ¥Ό κ±°μ³μ„ λ‹¤λ¥Έ λ…Έλ“λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ λ” μ§§μ€ κ²½μ°
              if cost < distance[j[0]]:
                  distance[j[0]] = cost
  
  # λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μν–‰
  dijkstra(start)
  
  # λ¨λ“  λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ±°λ¦¬λ¥Ό μ¶λ ¥
  for i in range(1, n + 1):
      # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, λ¬΄ν•(INFINITY)μ΄λΌκ³  μ¶λ ¥
      if distance[i] == INF:
          print("INFINITY")
      # λ„λ‹¬ν•  μ μλ” κ²½μ° κ±°λ¦¬λ¥Ό μ¶λ ¥
      else:
          print(distance[i])
  ```

#### κ°„λ‹¨ν• κµ¬ν„ λ°©λ²• μ„±λ¥ λ¶„μ„

* μ΄ O(V)λ² κ±Έμ³μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό λ§¤λ² μ„ ν• νƒμƒ‰ν•΄μ•Ό ν•¨
* λ”°λΌμ„ μ „μ²΄ μ‹κ°„ λ³µμ΅λ„λ” O(V<sup>2</sup>)μ„
* μΌλ°μ μΌλ΅ μ½”λ”© ν…μ¤νΈμ μµλ‹¨ κ²½λ΅ λ¬Έμ μ—μ„ μ „μ²΄ λ…Έλ“μ κ°μκ°€ 5,000κ° μ΄ν•λΌλ©΄ μ΄ μ½”λ“λ΅ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμ.
  * ν•μ§€λ§ λ…Έλ“μ κ°μκ°€ 10,000κ°λ¥Ό λ„μ–΄κ°€λ” λ¬Έμ λΌλ©΄ μ–΄λ–»κ² ν•΄μ•Ό ν• κΉ?

#### μ°μ„ μμ„ ν(Priority Queue)

* <u>μ°μ„ μμ„κ°€ κ°€μ¥ λ†’μ€ λ°μ΄ν„°λ¥Ό κ°€μ¥ λ¨Όμ € μ‚­μ </u>ν•λ” μλ£κµ¬μ΅°

* μλ¥Ό λ“¤μ–΄ μ—¬λ¬ κ°μ λ¬Όκ±΄ λ°μ΄ν„°λ¥Ό μλ£κµ¬μ΅°μ— λ„£μ—λ‹¤κ°€ κ°€μΉκ°€ λ†’μ€ λ¬Όκ±΄ λ°μ΄ν„°λ¶€ν„° κΊΌλ‚΄μ„ ν™•μΈν•΄μ•Ό ν•λ” κ²½μ°μ— μ°μ„ μμ„ νλ¥Ό μ΄μ©ν•  μ μμ

* Python, C++, Javaλ¥Ό ν¬ν•¨ν• λ€λ¶€λ¶„μ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ—μ„ **ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ ν•νƒλ΅ μ§€μ›**

  | μλ£κµ¬μ΅°                    | μ¶”μ¶λλ” λ°μ΄ν„°             |
  | --------------------------- | --------------------------- |
  | μ¤νƒ(Stack)                 | κ°€μ¥ λ‚μ¤‘μ— μ‚½μ…λ λ°μ΄ν„°   |
  | ν(Queue)                   | κ°€μ¥ λ¨Όμ € μ‚½μ…λ λ°μ΄ν„°     |
  | μ°μ„ μμ„ ν(Priority Queue) | κ°€μ¥ μ°μ„ μμ„κ°€ λ†’μ€ λ°μ΄ν„° |

#### ν™(Heap)

* <u>μ°μ„ μμ„ ν(Priority Queue)λ¥Ό κµ¬ν„ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μλ£κµ¬μ΅° μ¤‘ ν•λ‚</u>μ„

* **μµμ† ν™(Min Heap)**κ³Ό **μµλ€ ν™(Max Heap)**μ΄ μμ

* λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ„ ν¬ν•¨ν•΄ λ‹¤μ–‘ν• μ•κ³ λ¦¬μ¦μ—μ„ μ‚¬μ©λ¨

  | μ°μ„ μμ„ ν κµ¬ν„ λ°©μ‹ | μ‚½μ… μ‹κ°„ | μ‚­μ  μ‹κ°„ |
  | --------------------- | --------- | --------- |
  | λ¦¬μ¤νΈ                | O(1)      | O(N)      |
  | ν™(Heap)              | O(logN)   | O(logN)   |

* μµμ†ν™

  ```python
  import heapq
  
  # μ¤λ¦„μ°¨μ ν™ μ •λ ¬(Heap Sort)
  def heapsort(iterable):
      h = []
      result = []
      # λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ ν™μ— μ‚½μ…
      for value in iterable:
          heapq.heappush(h, value)
      # ν™μ— μ‚¬μ…λ λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ κΊΌλ‚΄μ–΄ λ‹΄κΈ°
      for i in range(len(h)):
          result.append(heapq.heappop(h))
      return result
  
  result = heapsort([1, 3, 5, 7, 9, 2, 4, 6, 8, 0])
  print(result)
  
  # μ‹¤ν–‰ κ²°κ³Ό
  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  ```

* μµλ€ ν™

  ```python
  import heapq
  
  # μ¤λ¦„μ°¨μ ν™ μ •λ ¬(Heap Sort)
  def heapsort(iterable):
      h = []
      result = []
      # λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ ν™μ— μ‚½μ…
      for value in iterable:
          heapq.heappush(h, -value)
      # ν™μ— μ‚¬μ…λ λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ κΊΌλ‚΄μ–΄ λ‹΄κΈ°
      for i in range(len(h)):
          result.append(-heapq.heappop(h))
      return result
  
  result = heapsort([1, 3, 5, 7, 9, 2, 4, 6, 8, 0])
  print(result)
  
  # μ‹¤ν–‰ κ²°κ³Ό
  [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
  ```

#### κ°μ„ λ κµ¬ν„ λ°©λ²•

* λ‹¨κ³„λ§λ‹¤ <u>λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒ</u>ν•κΈ° μ„ν•΄ **ν™(Heap)** μλ£ κµ¬μ΅°λ¥Ό μ΄μ©ν•¨
* λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ΄ λ™μ‘ν•λ” **κΈ°λ³Έ μ›λ¦¬λ” λ™μΌ**ν•¨
  * ν„μ¬ κ°€μ¥ κ°€κΉμ΄ λ…Έλ“λ¥Ό μ €μ¥ν•΄ λ†“κΈ° μ„ν•΄μ„ ν™ μλ£κµ¬μ΅°λ¥Ό μ¶”κ°€μ μΌλ΅ μ΄μ©ν•λ‹¤λ” μ μ΄ λ‹¤λ¦„
  * ν„μ¬μ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒν•΄μ•Ό ν•λ―€λ΅ μµμ† ν™μ„ μ‚¬μ©

#### λ™μ‘κ³Όμ • μ‚΄ν΄λ³΄κΈ° (μ°μ„ μμ„ ν)

* [μ΄κΈ° μƒνƒ] κ·Έλν”„λ¥Ό μ¤€λΉ„ν•κ³  μ¶λ° λ…Έλ“λ¥Ό μ„¤μ •ν•μ—¬ μ°μ„ μμ„ νμ— μ‚½μ…ν•¨

  ![](./image/9_1-12.png)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• | λ¬΄ν• |

* [Step 1] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 1λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-13.png)

  | μΈμ ‘ λ…Έλ“ | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | --------- | ------- | --------- | --------- |
  | 2λ²       | λ¬΄ν•    | 0+2       | True      |
  | 3λ²       | λ¬΄ν•    | 0+5       | True      |
  | 4λ²       | λ¬΄ν•    | 0+1       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 5    | 1    | λ¬΄ν• | λ¬΄ν• |

* [Step 2] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 4λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-14.png)

  | μΈμ ‘ λ…Έλ“ | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | --------- | ------- | --------- | --------- |
  | 3λ²       | 5       | 1+3       | True      |
  | 5λ²       | λ¬΄ν•    | 1+1       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 4    | 1    | 2    | λ¬΄ν• |

* [Step 3] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 2λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-15.png)

  |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | ---- | ------- | --------- | --------- |
  | 3λ²  | 4       | 2+3       | False     |
  | 5λ²  | 1       | 2+2       | False     |

    > ν„μ¬ κ°’λ³΄λ‹¤ κ±°μ³κ°€λ” κ°’μ΄ λ” ν¬κΈ° λ•λ¬Έμ— κ°±μ‹ ν•μ§€ μ•μ.
    >
    > (ν„μ¬ κ°’ < κ±°μ³κ°€λ” κ°’)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 4    | 1    | 2    | λ¬΄ν• |

* [Step 4] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 5λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-16.png)

  |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | ---- | ------- | --------- | --------- |
  | 3λ²  | 4       | 2+1       | True      |
  | 6λ²  | λ¬΄ν•    | 2+2       | True      |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 5] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 3λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-17.png)

  |      | ν„μ¬ κ°’ | κ±°μ³κ° λ• | κ°±μ‹  μ—¬λ¶€ |
  | ---- | ------- | --------- | --------- |
  | 2λ²  | 2       | 3+3       | False     |
  | 6λ²  | 4       | 3+5       | False     |

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 6] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 3λ² λ…Έλ“λ” μ΄λ―Έ λ°©λ¬Έν–μΌλ―€λ΅ λ¬΄μ‹ν•¨

  ![](./image/9_1-18.png)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 7] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 6λ² λ…Έλ“λ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅ μ΄λ¥Ό μ²λ¦¬ν•¨

  ![](./image/9_1-19.png)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

* [Step 8] μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλƒ…λ‹λ‹¤. 3λ² λ…Έλ“λ” μ΄λ―Έ λ°©λ¬Έν–μΌλ―€λ΅ λ¬΄μ‹ν•¨

  ![](./image/9_1-20.png)

  | λ…Έλ“ λ²νΈ | 1    | 2    | 3    | 4    | 5    | 6    |
  | --------- | ---- | ---- | ---- | ---- | ---- | ---- |
  | κ±°λ¦¬      | 0    | 2    | 3    | 1    | 2    | 4    |

#### κ°μ„ λ κµ¬ν„ λ°©λ²•

```python
import heapq
import sys
input = sys.stdin.readline
INF = int(1e9) # λ¬΄ν•μ„ μλ―Έν•λ” κ°’μΌλ΅ 10μ–µμ„ μ„¤μ •

# λ…Έλ“μ κ°μ, κ°„μ„ μ κ°μλ¥Ό μ…λ ¥λ°›κΈ°
n, m = map(int, input().split())
# μ‹μ‘ λ…Έλ“ λ²νΈλ¥Ό μ…λ ¥λ°›κΈ°
start = int(input())
# κ° λ…Έλ“μ— μ—°κ²°λμ–΄ μλ” λ…Έλ“μ— λ€ν• μ •λ³΄λ¥Ό λ‹΄λ” λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
graph = [[] for i in range(n + 1)]
# μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ λ¨λ‘ λ¬΄ν•μΌλ΅ μ΄κΈ°ν™”
distance = [INF] * (n + 1)

# λ¨λ“  κ°„μ„  μ •λ³΄λ¥Ό μ…λ ¥λ°›κΈ°
for _ in range(m):
    a, b, c = map(int, input().split())
    # aλ² λ…Έλ“μ—μ„ bλ² λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ΄ cλΌλ” μλ―Έ
    graph[a].append((b, c))

def dijkstra(start):
    q = []
    # μ‹μ‘ λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ²½λ΅λ” 0μΌλ΅ μ„¤μ •ν•μ—¬, νμ— μ‚½μ…
    heapq.heappush(q, (0, start))
    distance[start] = 0
    while q: # νκ°€ λΉ„μ–΄μμ§€ μ•λ‹¤λ©΄
        # κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“μ— λ€ν• μ •λ³΄ κΊΌλ‚΄κΈ°
        dist, now = heapq.heappop(q)
        # ν„μ¬ λ…Έλ“κ°€ μ΄λ―Έ μ²λ¦¬λ μ μ΄ μλ” λ…Έλ“λΌλ©΄ λ¬΄μ‹
        if distance[now] < dist:
            continue
        # ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ μΈμ ‘ν• λ…Έλ“λ“¤μ„ ν™•μΈ
        for i in graph[now]:
            cost = dist + i[1]
            # ν„μ¬ λ…Έλ“λ¥Ό κ±°μ³μ„, λ‹¤λ¥Έ λ…Έλ“λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ λ” μ§§μ€ κ²½μ°
            if cost < distance[i[0]]:
                distance[i[0]] = cost
                heapq.heappush(q, (cost, i[0]))

# λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μν–‰
dijkstra(start)

# λ¨λ“  λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ±°λ¦¬λ¥Ό μ¶λ ¥
for i in range(1, n + 1):
    # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, λ¬΄ν•(INFINITY)μ΄λΌκ³  μ¶λ ¥
    if distance[i] == INF:
        print("INFINITY")
    # λ„λ‹¬ν•  μ μλ” κ²½μ° κ±°λ¦¬λ¥Ό μ¶λ ¥
    else:
        print(distance[i])
```

#### κ°μ„ λ κµ¬ν„ λ°©λ²• μ„±λ¥ λ¶„μ„

* ν™ μλ£κµ¬μ΅°λ¥Ό μ΄μ©ν•λ” λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ μ‹κ°„ λ³µμ΅λ„λ” `O(ElogV)`μ„
* λ…Έλ“λ¥Ό ν•λ‚μ”© κΊΌλ‚΄ κ²€μ‚¬ν•λ” λ°λ³µλ¬Έ(whileλ¬Έ)μ€ λ…Έλ“μ κ°μ Vμ΄μƒμ νμλ΅λ” μ²λ¦¬λμ§€ μ•μ
  * κ²°κ³Όμ μΌλ΅ ν„μ¬ μ°μ„ μμ„ νμ—μ„ κΊΌλ‚Έ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ λ…Έλ“λ“¤μ„ ν™•μΈν•λ” μ΄ νμλ” μµλ€ κ°„μ„ μ κ°μ(E)λ§νΌ μ—°μ‚°μ΄ μν–‰λ  μ μμ
* μ§κ΄€μ μΌλ΅ <u>μ „μ²΄ κ³Όμ •μ€ Eκ°μ μ›μ†λ¥Ό μ°μ„ μμ„ νμ— λ„£μ—λ‹¤κ°€ λ¨λ‘ λΉΌλ‚΄λ” μ—°μ‚°κ³Ό λ§¤μ° μ μ‚¬</u>ν•¨
  * μ‹κ°„ λ³µμ΅λ„λ¥Ό O(ElogE)λ΅ νλ‹¨ν•  μ μμ
  * μ¤‘λ³µ κ°„μ„ μ„ ν¬ν•¨ν•μ§€ μ•λ” κ²½μ°μ— μ΄λ¥Ό O(ElogV)λ΅ μ •λ¦¬ ν•  μ μμ
  * O(ElogE) β†’ O(ElogV<sup>2</sup>) β†’ O(2ElogV) β†’ O(ElogV)
